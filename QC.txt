SELECT * FROM crosstab('SELECT cast(dim_t.año AS text) , dim_u.pais_country,cast( sum( price* quantity) as text) FROM dim_u , dim_t , dim_p , Prueba WHERE dim_u.cliente_customerid=Prueba.dim_u_cliente_customerid and dim_t.orden_orderdate=Prueba.dim_t_orden_orderdate and dim_p.producto_prod_id=Prueba.dim_p_producto_prod_id and (dim_u.pais_country=''Chile'') AND (dim_p.categoria_categoryname=''Action'') GROUP BY pais_country , año ORDER BY 1,2 ','SELECT pais_country FROM  ( SELECT  row_number() OVER (ORDER BY(pais_country) )as N, pais_country FROM dim_u GROUP BY pais_country,pais_country) AS T WHERE pais_country=''Chile''') AS act (dim_t text  , "Chile" text);;