SELECT * FROM crosstab('SELECT cast(dim_p.producto_nombre AS text) , dim_tiempo.año,cast( sum( cantidad) as text) FROM dim_tiempo , dim_p , dim_u , Prueba WHERE dim_tiempo.factura_num_factura=Prueba.dim_tiempo_factura_num_factura and dim_p.producto_id_producto=Prueba.dim_p_producto_id_producto and dim_u.factura_num_factura=Prueba.dim_u_factura_num_factura AND (dim_u.pais_nombre=''Guatemala'') GROUP BY año , producto_nombre ORDER BY 1,2 ','SELECT año FROM  ( SELECT  row_number() OVER (ORDER BY(año) )as N, año FROM dim_tiempo GROUP BY año,año) AS T') AS act (dim_p text  , "2011" text);;