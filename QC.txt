SELECT * FROM crosstab('SELECT cast(dim_v.vendedor_vendor_name AS text) , dim_p.categoria_categoryname,cast( sum( quantity) as text) FROM dim_p , dim_v , dim_t , Prueba WHERE dim_p.producto_prod_id=Prueba.dim_p_producto_prod_id and dim_v.vendedor_vendor_id=Prueba.dim_v_vendedor_vendor_id and dim_t.orden_orderdate=Prueba.dim_t_orden_orderdate GROUP BY categoria_categoryname , vendedor_vendor_name ORDER BY 1,2 ','SELECT categoria_categoryname FROM  ( SELECT  row_number() OVER (ORDER BY(categoria_categoryname) )as N, categoria_categoryname FROM dim_p GROUP BY categoria_categoryname,categoria_categoryname) AS T') AS act (dim_v text  , "Action" text , "Animation" text , "Children" text , "Classics" text , "Comedy" text , "Documentary" text , "Drama" text , "Family" text , "Foreign" text , "Games" text , "Horror" text , "Music" text , "New" text , "Sci-Fi" text , "Sports" text , "Travel" text);;