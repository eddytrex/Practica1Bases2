Select * FROM (SELECT * FROM crosstab('SELECT cast(dim_p.categoria_categoryname AS text) , dim_t.año,cast( sum( quantity+ price) as text) FROM dim_t , dim_p , dim_v , Prueba WHERE dim_t.orden_orderdate=Prueba.dim_t_orden_orderdate and dim_p.producto_prod_id=Prueba.dim_p_producto_prod_id and dim_v.vendedor_vendor_id=Prueba.dim_v_vendedor_vendor_id AND (dim_v.vendedor_vendor_name=''vendor1'') GROUP BY año , categoria_categoryname ORDER BY 1,2 ','SELECT año FROM  ( SELECT  row_number() OVER (ORDER BY(año) )as N, año FROM dim_t GROUP BY año,año) AS T') AS act (dim_p text  , "2004" text)) AS T WHERE  dim_p= 'Action';;